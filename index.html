<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portfolio Investimenti</title>

  <link rel="stylesheet" href="style.css?v=11">

  <!-- XLSX -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script type="module" src="main.js?v=4"></script>
</head>

<body data-theme="light">

<div class="app">

  <!-- HEADER -->
  <header class="app-header">
    <div class="header-left">
      <h1>ğŸ’¼ Portfolio Manager</h1>
      <span class="subtitle">Francesco La Gattuta</span>
    </div>

    <!-- THEME TOGGLE -->
    <div class="theme-toggle">
      <label class="switch">
        <input type="checkbox" id="themeSwitch">
        <span class="slider"></span>
      </label>
      <span id="themeLabel"></span>
    </div>
  </header>

  <!-- STATS -->
  <section class="stats-grid">
    <article class="stat-card">
      <span class="stat-label">Totale Investito</span>
      <span class="stat-value" id="totInvestito">0.00 â‚¬</span>
    </article>

    <article class="stat-card">
      <span class="stat-label">Valore Attuale</span>
      <span class="stat-value" id="valoreAttuale">0.00 â‚¬</span>
    </article>

    <article class="stat-card">
      <span class="stat-label">Dividendi</span>
      <span class="stat-value" id="totDividendi">0.00 â‚¬</span>
    </article>

    <article class="stat-card highlight">
      <span class="stat-label">Profitto Totale</span>
      <span class="stat-value" id="totProfitto">0.00 â‚¬</span>
      <span class="stat-subvalue" id="totProfittoPerc">0%</span>
    </article>
  </section>

  <!-- CONTROLLI -->
  <section class="controls">
    <label class="file-label">
      ğŸ“¥ Importa Excel
      <input type="file" accept=".xlsx,.xls" onchange="importExcel(event)">
    </label>

    <button class="export-btn" onclick="exportExcel()">ğŸ“¤ Esporta Excel</button>

    <nav class="nav-links">
      <a href="dashboard.html">ğŸ“Š Dashboard</a>
      <a href="dividendi.html">ğŸ’µ Dividendi</a>
      <a href="andamento.html">ğŸ“ˆ Andamento</a>
      <a href="calendario.html">ğŸ—“ï¸ Calendario</a>
      <a href="score.html">â­ Score</a>
    </nav>
  </section>

  <!-- TABELLA -->
  <section class="table-container">
    <table>
      <thead>
        <tr id="headerRow"></tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </section>

</div>

<div id="modal-root"></div>

<!-- THEME SCRIPT (IDENTICO, solo ripulito) -->
<script>
  const switchEl = document.getElementById("themeSwitch");
  const themeLabel = document.getElementById("themeLabel");

  const saved = localStorage.getItem("theme") || "light";
  document.body.dataset.theme = saved;
  document.body.classList.toggle("dark", saved === "dark");
  switchEl.checked = saved === "dark";
  themeLabel.textContent = saved === "dark" ? "ğŸŒ™ Dark" : "â˜€ï¸ Light";

  switchEl.addEventListener("change", () => {
    const mode = switchEl.checked ? "dark" : "light";
    document.body.dataset.theme = mode;
    document.body.classList.toggle("dark", mode === "dark");
    themeLabel.textContent = mode === "dark" ? "ğŸŒ™ Dark" : "â˜€ï¸ Light";
    localStorage.setItem("theme", mode);
  });
</script>

</body>
</html>
