<!DOCTYPE html>
<html lang="it">
<head>
Â  <meta charset="utf-8" />
Â  <meta name="viewport" content="width=device-width,initial-scale=1" />
Â  <title>Portafoglio Investimenti</title>

Â  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
Â  Â  <link rel="stylesheet" href="index.css?v=13">Â  Â Â 
Â  Â  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
Â  Â  <script type="module" src="main.js?v=6"></script>
</head>
<body data-theme="light">

Â  <div class="container">

Â  Â  <header>
Â  Â  Â  <div class="header-top" style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  <h1 style="margin:0;">ğŸ’¼ Portfolio Manager</h1>
Â  Â  Â  Â  Â  <p class="subtitle" style="margin:4px 0 0;">Francesco La Gattuta</p>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="theme-toggle">
Â  <label class="switch">
Â  Â  <input type="checkbox" id="themeSwitch">
Â  Â  <span class="slider"></span>
Â  </label>
Â  <span id="themeLabel"></span>
</div>
Â  Â  Â  </div>
Â  Â  </header>

Â  Â  Â  Â  <div class="stats-grid">
Â  Â  Â  
        Â  Â  Â  <div class="stat-card">
Â  Â  Â  Â  <div class="stat-label">Totale Investito</div>
        Â  Â  Â  Â  <div class="stat-value-container">
            <div class="stat-value" id="totInvestito">0.00 â‚¬</div>
        </div>
Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="stat-card">
Â  Â  Â  Â  <div class="stat-label">Valore Attuale</div>
        Â  Â  Â  Â  <div class="stat-value-container">
            <div class="stat-value" id="valoreAttuale">0.00 â‚¬</div>
        </div>
Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="stat-card">
Â  Â  Â  Â  <div class="stat-label">Totale Dividendi</div>
        Â  Â  Â  Â  <div class="stat-value-container">
            <div class="stat-value" id="totDividendi">0.00 â‚¬</div>
        </div>
Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â <div class="stat-card">
Â  <div class="stat-label">Profitto Totale</div>
    Â  <div class="stat-value" id="totProfitto">0.00 â‚¬</div>
Â  <div class="stat-subvalue" id="totProfittoPerc">0%</div>
</div>
Â  Â  </div>

Â  Â  Â  Â  <div class="controls">
Â  <label class="file-label">
Â  Â  ğŸ“¥ Importa Excel
Â  Â  <input type="file" accept=".xlsx,.xls" onchange="importExcel(event)">
Â  </label>

Â  <button class="export-btn" onclick="exportExcel()">ğŸ“¤ Esporta Excel</button>

Â  <a class="dashboard-btn" href="dashboard.html">ğŸ“Š Dashboard</a>Â Â 
Â  <a class="dashboard-btn" href="dividendi.html">ğŸ’µ Dividendi</a>
Â  <a class="dashboard-btn" href="andamento.html">ğŸ“ˆ Andamento</a>
Â  <a class="dashboard-btn" href="calendario.html">ğŸ—“ï¸ Calendario</a>
Â  <a class="dashboard-btn" href="score.html">â­ Score</a>
</div>

Â  Â  Â  Â  <div class="table-container">
Â  Â  Â  <table>
Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  <tr id="headerRow"></tr>
Â  Â  Â  Â  </thead>
Â  Â  Â  Â  <tbody id="tableBody"></tbody>
Â  Â  Â  </table>
Â  Â  </div>

Â  </div>

Â  Â  <div id="modal-root"></div>
<script>
Â  const switchEl = document.getElementById("themeSwitch");
Â  const themeLabel = document.querySelector('.theme-toggle span') || document.getElementById("themeLabel");

Â  // Legge preferenza (o fallback a light)
Â  const saved = localStorage.getItem("theme") || "light";
Â  document.body.dataset.theme = saved;
Â  if (saved === "dark") document.body.classList.add("dark");
Â  switchEl.checked = saved === "dark";
Â  if(themeLabel) themeLabel.textContent = saved === "dark" ? "ğŸŒ™ Dark" : "â˜€ï¸ Light";

Â  switchEl.addEventListener("change", () => {
Â  Â  const mode = switchEl.checked ? "dark" : "light";
Â  Â  document.body.dataset.theme = mode;
Â  Â  if(mode === "dark") document.body.classList.add("dark");
Â  Â  else document.body.classList.remove("dark");
Â  Â  if(themeLabel) themeLabel.textContent = mode === "dark" ? "ğŸŒ™ Dark" : "â˜€ï¸ Light";
Â  Â  localStorage.setItem("theme", mode);
Â  });
</script>

</body>
</html>
